<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DSA Ultimate Mastery Roadmap - Complete Interactive Tracker</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .reset-button, .export-button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .export-button {
            background: #28a745;
        }

        .reset-button:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .export-button:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .progress-dashboard {
            padding: 30px;
            background: white;
        }

        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .progress-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .progress-card h3 {
            font-size: 1.1em;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .progress-number {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .progress-bar {
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            height: 8px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .week-section {
            margin: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            overflow: hidden;
            border: 1px solid #e9ecef;
        }

        .week-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .week-header:hover {
            background: linear-gradient(135deg, #3d8bfe 0%, #00d4fe 100%);
        }

        .week-header h2 {
            font-size: 1.4em;
        }

        .week-toggle {
            font-size: 1.5em;
            transition: transform 0.3s ease;
        }

        .week-content {
            padding: 25px;
            display: none;
        }

        .week-content.active {
            display: block;
        }

        .theory-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #007bff;
        }

        .problems-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .problems-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9em;
            border-right: 2px solid rgba(255, 255, 255, 0.2);
        }

        .problems-table th:last-child {
            border-right: none;
        }

        .problems-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
            text-align: center;
            vertical-align: middle;
        }

        .problems-table td:last-child {
            border-right: none;
        }

        .problems-table tr:hover {
            background: #f8f9fa;
        }

        .problems-table tr:last-child td {
            border-bottom: none;
        }

        /* Column width adjustments */
        .problems-table th:nth-child(1), /* Problem name */
        .problems-table td:nth-child(1) {
            width: 18%;
            text-align: left;
        }

        .problems-table th:nth-child(2), /* Difficulty */
        .problems-table td:nth-child(2) {
            width: 8%;
        }

        .problems-table th:nth-child(3), /* Pattern */
        .problems-table td:nth-child(3) {
            width: 12%;
        }

        .problems-table th:nth-child(4), /* Complexity */
        .problems-table td:nth-child(4) {
            width: 12%;
        }

        .problems-table th:nth-child(5), /* Approach */
        .problems-table td:nth-child(5) {
            width: 15%;
        }

        .problems-table th:nth-child(6), /* LeetCode */
        .problems-table td:nth-child(6) {
            width: 8%;
        }

        .problems-table th:nth-child(7), /* Company Tags */
        .problems-table td:nth-child(7) {
            width: 12%;
        }

        .problems-table th:nth-child(8), /* Status */
        .problems-table td:nth-child(8) {
            width: 5%;
        }

        .problems-table th:nth-child(9), /* Notes */
        .problems-table td:nth-child(9) {
            width: 20%;
            text-align: left;
        }

        .difficulty-easy { 
            color: #28a745; 
            font-weight: bold;
            background: #d4edda;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .difficulty-medium { 
            color: #fd7e14; 
            font-weight: bold;
            background: #fff3cd;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .difficulty-hard { 
            color: #dc3545; 
            font-weight: bold;
            background: #f8d7da;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
        }

        .company-tags {
            font-size: 0.8em;
            color: #6c757d;
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
            max-width: 100%;
            word-wrap: break-word;
        }

        .leetcode-link {
            color: #007bff;
            text-decoration: none;
            font-weight: 600;
            background: #e3f2fd;
            padding: 6px 10px;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: inline-block;
            min-width: 60px;
            text-align: center;
        }

        .leetcode-link:hover {
            background: #bbdefb;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .custom-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
            transform: scale(1.2);
            accent-color: #28a745;
            margin: 0 auto;
            display: block;
        }

        /* Style revision checkboxes to match custom-checkbox */
        input[type="checkbox"][data-revision] {
            width: 22px;
            height: 22px;
            cursor: pointer;
            transform: scale(1.2);
            accent-color: #28a745;
            margin: 0 auto;
            display: block;
        }

        .notes-input {
            width: 100%;
            min-width: 200px;
            padding: 10px 12px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9em;
            font-family: inherit;
            background: #f8f9fa;
            transition: all 0.3s ease;
            resize: vertical;
            min-height: 40px;
            max-height: 120px;
        }

        .notes-input:focus {
            outline: none;
            border-color: #007bff;
            background: white;
            box-shadow: 0 0 0 2px rgba(0,123,255,0.1);
        }

        .notes-input::placeholder {
            color: #6c757d;
            font-style: italic;
        }

        .complexity-badge {
            font-size: 0.75em;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
            margin: 2px;
            display: inline-block;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
        }

        .time-complexity {
            background: #e8f5e8;
            color: #2d5a2d;
            border: 1px solid #c3e6c3;
        }

        .space-complexity {
            background: #e8f0ff;
            color: #1a365d;
            border: 1px solid #bee3f8;
        }

        .approach-tracker {
            display: flex;
            gap: 5px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            margin: 5px 0;
        }

        .approach-badge {
            font-size: 0.7em;
            padding: 3px 6px;
            border-radius: 10px;
            background: #f1f3f4;
            color: #5f6368;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
            white-space: nowrap;
        }

        .approach-badge.completed {
            background: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }

        .approach-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .pattern-highlight {
            background: linear-gradient(45deg, #fff3cd, #ffeaa7);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85em;
        }

        .depth-indicator {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-weight: bold;
            margin-left: 5px;
        }

        .depth-shallow { background: #ffebee; color: #c62828; }
        .depth-medium { background: #fff3e0; color: #ef6c00; }
        .depth-deep { background: #e8f5e8; color: #2e7d32; }

        .week-progress {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
            border-left: 4px solid #2196f3;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .week-stats {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .stat-item {
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            display: none;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .search-container {
            margin: 20px 0;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        .clear-search-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .clear-search-btn:hover {
            background: #c82333;
            transform: translateY(-50%) scale(1.1);
        }

        .filter-btn {
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .filter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .filter-btn.active {
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            transform: translateY(0);
        }

        .search-highlight {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 5px;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-style: italic;
        }

        /* Pattern description styles */
        .pattern-description {
            background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-size: 0.9em;
        }

        .pattern-description h4 {
            color: #1976d2;
            margin: 0 0 8px 0;
            font-size: 1em;
        }

        .pattern-description ul {
            margin: 5px 0;
            padding-left: 20px;
        }

        .pattern-description li {
            margin: 3px 0;
            color: #424242;
        }

        .pattern-description .works-for {
            font-weight: 600;
            color: #2e7d32;
        }

        .pattern-description .look-for {
            font-weight: 600;
            color: #d32f2f;
        }

        /* Problem hint styles */
        .problem-hint {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 4px;
            font-size: 0.85em;
            color: #e65100;
            cursor: help;
            transition: all 0.3s ease;
        }

        .problem-hint:hover {
            background: #ffe0b2;
            transform: translateX(2px);
        }

        .problem-hint-icon {
            display: inline-block;
            width: 16px;
            height: 16px;
            background: #ff9800;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 16px;
            font-size: 10px;
            margin-right: 5px;
            font-weight: bold;
        }

        /* Pattern badge with tooltip */
        .pattern-badge {
            position: relative;
            cursor: help;
            transition: all 0.3s ease;
        }

        .pattern-badge:hover {
            transform: scale(1.05);
        }

        .pattern-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-size: 0.8em;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            pointer-events: none;
            max-width: 300px;
            white-space: normal;
        }

        .pattern-badge:hover .pattern-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-5px);
        }

        .pattern-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #333;
        }

        /* Pattern section styles */
        .patterns-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid #dee2e6;
        }

        .patterns-section h3 {
            font-size: 1.2em;
            font-weight: 600;
        }

        .pattern-description {
            background: white;
            border: 1px solid #e3f2fd;
            transition: all 0.3s ease;
        }

        .pattern-description:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .pattern-badge {
            transition: all 0.3s ease;
            padding: 2px 6px;
            border-radius: 4px;
        }

        .pattern-badge:hover {
            background: #e3f2fd;
            transform: scale(1.05);
        }

        /* Problem hint styles for individual problems */
        .problem-hint {
            background: #fff3e0;
            border-left: 3px solid #ff9800;
            padding: 4px 6px;
            margin: 3px 0;
            border-radius: 3px;
            font-size: 0.75em;
            color: #e65100;
            cursor: help;
            transition: all 0.3s ease;
        }

        .problem-hint:hover {
            background: #ffe0b2;
            transform: translateX(2px);
        }

        .problem-hint-icon {
            display: inline-block;
            width: 12px;
            height: 12px;
            background: #ff9800;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 12px;
            font-size: 8px;
            margin-right: 3px;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2em; }
            .header p { font-size: 1em; }
            .week-section { margin: 15px; }
            .problems-table { font-size: 0.9em; }
            .problems-table th, .problems-table td { padding: 10px 8px; }
        }
    </style>
</head>
<body>
    <div id="auth-modal" style="display:none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);">
        <div style="background-color: #fefefe; margin: 10% auto; padding: 20px; border-radius: 10px; border: 1px solid #888; width: 80%; max-width: 400px; text-align: center; position: relative;">
            <span id="close-modal" style="position: absolute; top: 10px; right: 20px; font-size: 24px; cursor: pointer; color: #aaa;">×</span>
            <h2 id="modal-title" style="margin-bottom: 20px;">Login</h2>
            
            <!-- Google Sign-In Button -->
            <button id="google-signin-btn" style="width: 100%; padding: 12px; margin-bottom: 15px; background: #4285f4; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="white">
                    <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                    <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                    <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                    <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                </svg>
                Continue with Google
            </button>
            
            <!-- Divider -->
            <div style="display: flex; align-items: center; margin: 15px 0;">
                <hr style="flex: 1; border: none; border-top: 1px solid #ddd;">
                <span style="padding: 0 15px; color: #666; font-size: 14px;">or</span>
                <hr style="flex: 1; border: none; border-top: 1px solid #ddd;">
            </div>
            
            <!-- Email/Password Form -->
            <input type="email" id="email-input" placeholder="Email" style="width: calc(100% - 40px); padding: 12px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; font-size: 1em;">
            <input type="password" id="password-input" placeholder="Password" style="width: calc(100% - 40px); padding: 12px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #ccc; font-size: 1em;">
            <p id="auth-error" style="color: red; display: none; margin-bottom: 15px;"></p>
            <button id="modal-login-btn" class="export-button" style="margin-right: 10px; background-color: #007bff; border-color: #007bff;">Login</button>
            <button id="modal-signup-btn" class="export-button">Sign Up</button>
            <p style="margin-top: 20px; font-size: 0.9em; color: #666;">New user? Enter credentials and click Sign Up.</p>
        </div>
    </div>
    <div class="save-indicator" id="saveIndicator">Progress Saved! ✓</div>
    
    <div class="container" style="/* filter: blur(3px); */">
        <div class="header">
            <h1>🚀 DSA Ultimate Mastery Roadmap</h1>
            <p><em>Data Structures First + Pattern Recognition | 24 Weeks | 284+ Problems</em></p>
            <div id="auth-container" style="display: flex; gap: 10px; align-items: center; position: absolute; top: 20px; right: 20px;">
                <span id="user-info" style="display: none; font-weight: 600;"></span>
                <button id="login-btn" class="export-button" style="background-color: rgb(0, 123, 255); border-color: rgb(0, 123, 255); display: block;">Login / Sign Up</button>
                <button id="logout-btn" class="reset-button" style="display: none;">Logout</button>
            </div>
        </div>
        <div class="content-container">
        <div class="controls">
            <div class="search-container" style="flex: 1; max-width: 400px;">
                <input type="text" class="search-input" id="searchInput" placeholder="🔍 Search problems, patterns, or companies...">
                <button class="clear-search-btn" id="clearSearchBtn" onclick="clearSearch()" style="display: none;">✕</button>
            </div>
            <div class="filter-buttons" style="display: flex; gap: 10px; margin-right: 15px;">
                <button class="filter-btn" onclick="filterByDifficulty('Easy')" style="background-color: #28a745; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">Easy</button>
                <button class="filter-btn" onclick="filterByDifficulty('Medium')" style="background-color: #fd7e14; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">Medium</button>
                <button class="filter-btn" onclick="filterByDifficulty('Hard')" style="background-color: #dc3545; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">Hard</button>
                <button class="filter-btn" onclick="clearFilters()" style="background-color: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-weight: 600;">Clear</button>
            </div>
            <div>
                <button class="export-button" onclick="exportProgress()">📊 Export Progress</button>
                <button class="reset-button" onclick="resetProgress()">🔄 Reset All</button>
                <button class="export-button" onclick="showAllPatterns()" style="background-color: #17a2b8; color: white;">📚 Pattern Guide</button>
            </div>
        </div>

        <div class="progress-dashboard">
            <div class="progress-grid">
                <div class="progress-card">
                    <h3>Total Problems</h3>
                    <div class="progress-number" id="total-problems">0/284</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="problems-progress" style="width: 0%"></div>
                    </div>
                    <div id="problems-percentage">0%</div>
                </div>
                <div class="progress-card">
                    <h3>Weeks Completed</h3>
                    <div class="progress-number" id="total-weeks">0/24</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="weeks-progress" style="width: 0%"></div>
                    </div>
                    <div id="weeks-percentage">0%</div>
                </div>
                <div class="progress-card">
                    <h3>Patterns Mastered</h3>
                    <div class="progress-number" id="total-patterns">0/28</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="patterns-progress" style="width: 0%"></div>
                    </div>
                    <div id="patterns-percentage">0%</div>
                </div>
                <div class="progress-card">
                    <h3>Study Streak</h3>
                    <div class="progress-number" id="study-streak">0 days</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="streak-progress" style="width: 0%"></div>
                    </div>
                    <div>Keep going! 🔥</div>
                </div>
            </div>
        </div>

        <!-- Dynamic Weeks Container - Replaces all hardcoded weeks -->
        <div id="weeks-container">
            <!-- Loading indicator while data loads -->
            <div id="loading" style="text-align: center; padding: 50px; font-size: 1.2em; color: #666;">
                <div style="margin-bottom: 20px;">🔄 Loading DSA Roadmap...</div>
                <div style="width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid #667eea; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
            </div>
                </div>

        <style>
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
        </style>

        </div>

    <!-- Include the data loader -->
    <script src="js/data-loader.js"></script>

    <script>
        // Use the global dsaLoader instance from data-loader.js
        // const dsaLoader = new DSADataLoader(); // REMOVED - using global instance
        
        // Global variables for progress tracking
        let currentUser = null;
        let progressData = { problems: {}, notes: {}, revisions: {} };
        let auth, db, unsubscribe;
        let saveData;
        let totalProblems = 284; // Will be updated dynamically
        let completedProblems = 0;

        // Pattern descriptions and hints
        const patternDescriptions = {
            'Two Pointers': {
                worksFor: 'Sort arrays, linked lists',
                lookFor: 'find pair, remove duplicates, merge',
                description: 'Use two pointers to traverse data structures efficiently, often reducing time complexity from O(n²) to O(n).'
            },
            'Sliding Window': {
                worksFor: 'Subarrays, substrings',
                lookFor: 'longest substring, max/min sum',
                description: 'Maintain a window of elements and slide it to find optimal subarrays or substrings.'
            },
            'Binary Search': {
                worksFor: 'Sorted or monotonic data',
                lookFor: 'kth smallest/largest, min/max value',
                description: 'Efficiently search in sorted data or find optimal values in monotonic functions.'
            },
            'Prefix Sum': {
                worksFor: 'Range sum or subarray sum',
                lookFor: 'generate all, find all ways, solve K',
                description: 'Precompute cumulative sums to answer range queries in O(1) time.'
            },
            'Backtracking': {
                worksFor: 'All combinations or paths',
                lookFor: 'generate all, solve maze, N-Queens',
                description: 'Systematically explore all possible solutions by building candidates incrementally.'
            },
            'DP (Memoization)': {
                worksFor: 'Repeated choices with optimal result',
                lookFor: 'min cost, max ways, longest path, overlapping subproblems',
                description: 'Store results of subproblems to avoid redundant calculations.'
            },
            'Stack / Queue': {
                worksFor: 'Next/previous, parentheses',
                lookFor: 'next greater element, valid brackets, span problems',
                description: 'Use LIFO/FIFO data structures for order-dependent operations.'
            },
            'DFS / BFS': {
                worksFor: 'Tree or graph traversal',
                lookFor: 'connected components, shortest path, level order',
                description: 'Systematically explore tree or graph structures.'
            },
            'Union-Find': {
                worksFor: 'Grouping, cycle detection',
                lookFor: 'are nodes connected, detect cycles, disjoint sets',
                description: 'Efficiently manage and query connected components in graphs.'
            },
            'Heap': {
                worksFor: 'Top-K, priorities',
                lookFor: 'kth largest, frequent items, sort & choose',
                description: 'Maintain priority queue for efficient access to min/max elements.'
            },
            'Trie / Bitmask': {
                worksFor: 'Word patterns, subsets',
                lookFor: 'starts with, word search, max XOR, subset generation',
                description: 'Use tree structures for string operations or bit manipulation for subsets.'
            }
        };

        // Problem-specific hints based on common patterns
        const problemHints = {
            'Two Pointers': [
                '💡 Look for sorted arrays or linked lists',
                '💡 Try using two pointers moving in opposite directions',
                '💡 Consider one pointer moving faster than the other'
            ],
            'Sliding Window': [
                '💡 Look for subarray/substring problems',
                '💡 Consider maintaining a window of fixed or variable size',
                '💡 Think about expanding and contracting the window'
            ],
            'Binary Search': [
                '💡 Check if the data is sorted or has monotonic properties',
                '💡 Look for "kth smallest/largest" or "find minimum/maximum"',
                '💡 Consider if the answer lies in a range'
            ],
            'Prefix Sum': [
                '💡 Look for range sum queries or subarray sum problems',
                '💡 Consider if you need to find all possible subarrays',
                '💡 Think about cumulative calculations'
            ],
            'Backtracking': [
                '💡 Look for "generate all" or "find all possible"',
                '💡 Consider if you need to explore all combinations',
                '💡 Think about building solutions incrementally'
            ],
            'DP (Memoization)': [
                '💡 Look for overlapping subproblems',
                '💡 Consider if choices affect future decisions',
                '💡 Think about optimal substructure'
            ],
            'Stack / Queue': [
                '💡 Look for order-dependent operations',
                '💡 Consider if you need to process elements in LIFO/FIFO order',
                '💡 Think about maintaining order or finding next/previous elements'
            ],
            'DFS / BFS': [
                '💡 Look for tree or graph traversal problems',
                '💡 Consider if you need to explore connected components',
                '💡 Think about finding shortest paths or level-order traversal'
            ],
            'Union-Find': [
                '💡 Look for grouping or connectivity problems',
                '💡 Consider if you need to detect cycles',
                '💡 Think about managing disjoint sets'
            ],
            'Heap': [
                '💡 Look for "top K" or priority-based problems',
                '💡 Consider if you need frequent access to min/max elements',
                '💡 Think about maintaining sorted order efficiently'
            ],
            'Trie / Bitmask': [
                '💡 Look for string pattern matching or prefix problems',
                '💡 Consider if you need to generate all subsets',
                '💡 Think about bit manipulation for optimization'
            ]
        };

        // Make pattern data available globally for data loader
        window.patternDescriptions = patternDescriptions;
        window.problemHints = problemHints;

        document.addEventListener('DOMContentLoaded', () => {
            // --- Firebase Integration ---
    
            // IMPORTANT: Replace with your actual Firebase project configuration
            const firebaseConfig = {
                    apiKey: "AIzaSyCKvhMfjN6IA_kHL2JmBeRdJ185fSMv5sI",
                    authDomain: "my-dsa-tracker-f1b09.firebaseapp.com",
                    projectId: "my-dsa-tracker-f1b09",
                    storageBucket: "my-dsa-tracker-f1b09.firebasestorage.app",
                    messagingSenderId: "323534860326",
                    appId: "1:323534860326:web:1ca288a34fea97e59336e7",
                    measurementId: "G-HX136694X6"
                };
            // Initialize Firebase
            try {
                firebase.initializeApp(firebaseConfig);
                console.log('✅ Firebase initialized successfully');
            } catch (e) {
                console.error("❌ Firebase initialization error:", e);
                if (!firebase.apps.length) {
                    alert("Could not initialize Firebase. Please check your configuration and ensure you've replaced the placeholder values.");
                }
            }


            const googleProvider = new firebase.auth.GoogleAuthProvider();
            googleProvider.addScope('email');
            googleProvider.addScope('profile');
    
            const googleSignInBtn = document.getElementById('google-signin-btn');

            googleSignInBtn.addEventListener('click', () => {
        authError.style.display = 'none';
        
        auth.signInWithPopup(googleProvider)
            .then((result) => {
                // Google sign-in successful
                console.log('Google sign-in successful:', result.user);
                authModal.style.display = 'none';
            })
            .catch((error) => {
                console.error('Google sign-in error:', error);
                
                // Handle account linking scenario
                if (error.code === 'auth/account-exists-with-different-credential') {
                    handleAccountLinking(error);
                } else {
                    authError.textContent = error.message;
                    authError.style.display = 'block';
                }
            });
    });
    function handleAccountLinking(error) {
        const existingEmail = error.email;
        const pendingCred = error.credential;
        
        // Show user-friendly message
        const linkAccount = confirm(
            `An account with ${existingEmail} already exists. ` +
            `Would you like to link your Google account to your existing email/password account? ` +
            `You'll need to sign in with your password first.`
        );
        
        if (linkAccount) {
            // Get sign-in methods for this email
            auth.fetchSignInMethodsForEmail(existingEmail)
                .then((methods) => {
                    console.log('Available sign-in methods:', methods);
                    
                    // Prompt user to sign in with existing method first
                    authError.innerHTML = `
                        <strong>Account Linking Required:</strong><br>
                        Please sign in with your email/password first, then we'll link your Google account.
                    `;
                    authError.style.display = 'block';
                    
                    // Store the Google credential for later linking
                    sessionStorage.setItem('pendingGoogleCredential', JSON.stringify(pendingCred));
                });
        } else {
            authError.textContent = 'Sign-in cancelled. Use your existing email/password to login.';
            authError.style.display = 'block';
        }
    }
            
            auth = firebase.auth();
            db = firebase.firestore();
    
            // --- Auth UI Elements ---
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const authModal = document.getElementById('auth-modal');
            const closeModal = document.getElementById('close-modal');
            const modalLoginBtn = document.getElementById('modal-login-btn');
            const modalSignupBtn = document.getElementById('modal-signup-btn');
            const emailInput = document.getElementById('email-input');
            const passwordInput = document.getElementById('password-input');
            const authError = document.getElementById('auth-error');
            const userInfo = document.getElementById('user-info');
            const mainContainer = document.querySelector('.container');
            const contentContainer = document.querySelector('.content-container');
    
            // --- Auth Logic ---
            loginBtn.addEventListener('click', () => authModal.style.display = 'block');
            logoutBtn.addEventListener('click', () => auth.signOut());
            closeModal.addEventListener('click', () => authModal.style.display = 'none');
            window.addEventListener('click', (event) => {
                if (event.target == authModal) {
                    authModal.style.display = 'none';
                }
            });

            modalSignupBtn.addEventListener('click', () => {
                const email = emailInput.value;
                const password = passwordInput.value;
                authError.style.display = 'none';
                if (!email || !password) {
                    authError.textContent = "Please enter a User ID and password.";
                    authError.style.display = 'block';
                    return;
                }
                auth.createUserWithEmailAndPassword(email, password)
                    .catch(error => {
                        authError.textContent = error.message;
                        authError.style.display = 'block';
                });
            });

            modalLoginBtn.addEventListener('click', () => {
        const email = emailInput.value;
        const password = passwordInput.value;
        authError.style.display = 'none';
        
        if (!email || !password) {
            authError.textContent = "Please enter email and password.";
            authError.style.display = 'block';
            return;
        }
        
        auth.signInWithEmailAndPassword(email, password)
            .then((result) => {
                // Check if there's a pending Google credential to link
                const pendingCred = sessionStorage.getItem('pendingGoogleCredential');
                if (pendingCred) {
                    const credential = JSON.parse(pendingCred);
                    
                    // Link the Google account
                    return result.user.linkWithCredential(credential)
                        .then(() => {
                            sessionStorage.removeItem('pendingGoogleCredential');
                            alert('Google account successfully linked! You can now sign in with Google.');
                            return result;
                        });
                }
                return result;
            })
            .catch(error => {
                authError.textContent = error.message;
                authError.style.display = 'block';
            });
    });
    
            auth.onAuthStateChanged(user => {
                if (user) {
                    // User is signed in
                    currentUser = user;
                    authModal.style.display = 'none';
                    loginBtn.style.display = 'none';
                    logoutBtn.style.display = 'block';
                    userInfo.innerHTML = `Welcome, <strong>${user.email}</strong>`;
                    userInfo.style.display = 'block';
                    contentContainer.style.filter = 'none';
                    
                    // Load user data from Firebase
                    loadData();
                } else {
                    // User is signed out
                    currentUser = null;
                    if (unsubscribe) {
                        unsubscribe();
                        unsubscribe = null;
                    }
                    loginBtn.style.display = 'block';
                    logoutBtn.style.display = 'none';
                    userInfo.style.display = 'none';
                    contentContainer.style.filter = 'blur(3px)';
                    clearUI();
                    updateAllProgress();
                }
            });
    
            // --- Firestore Data Logic ---
            function loadData() {
                if (!currentUser) return;
                const docRef = db.collection('users').doc(currentUser.uid);
                
                unsubscribe = docRef.onSnapshot((doc) => {
                    if (doc && doc.data()) {
                        const data = doc.data();
                        progressData = data;
                        // Ensure all required properties exist
                        if (!progressData.problems) progressData.problems = {};
                        if (!progressData.notes) progressData.notes = {};
                        if (!progressData.revisions) progressData.revisions = {};
                        if (!progressData.approaches) progressData.approaches = {};
                        updateUI();
                        updateAllProgress();
                    } else {
                        // Initialize empty progress for new user
                        progressData = { 
                            problems: {}, 
                            notes: {}, 
                            revisions: {}, 
                            approaches: {},
                            lastActivity: new Date().toISOString(),
                            studyStreak: 0
                        };
                        // Save initial data to Firestore
                        saveData();
                    }
                }, (error) => {
                    console.error("Error loading data from Firebase:", error);
                    // Fallback to localStorage
                    loadFromLocalStorage();
                });
            }

            // Initialize saveData function after Firebase setup
            saveData = function() {
                if (currentUser) {
                    // Save to Firestore
                    progressData.lastActivity = new Date().toISOString();
                    
                    db.collection('users').doc(currentUser.uid).set(progressData, { merge: true })
                        .then(() => {
                            showSaveIndicator();
                        })
                        .catch((error) => {
                            console.error("Error saving to Firestore:", error);
                            // Fallback to localStorage
                            saveToLocalStorage();
                        });
                } else {
                    // Save to localStorage for unauthenticated users
                    saveToLocalStorage();
                }
            };

            function saveToLocalStorage() {
                try {
                    localStorage.setItem('dsaProgress', JSON.stringify(progressData));
                    showSaveIndicator();
                    } catch (error) {
                    console.error('Error saving to localStorage:', error);
                    alert('Error saving data locally. Please check your browser storage settings.');
                }
            }

            function loadFromLocalStorage() {
                try {
                    const saved = localStorage.getItem('dsaProgress');
                    if (saved) {
                        progressData = JSON.parse(saved);
                        // Ensure all required properties exist
                        if (!progressData.problems) progressData.problems = {};
                        if (!progressData.notes) progressData.notes = {};
                        if (!progressData.revisions) progressData.revisions = {};
                        if (!progressData.approaches) progressData.approaches = {};
                        updateUI();
                        updateAllProgress();
                    } else {
                        progressData = { 
                            problems: {}, 
                            notes: {}, 
                            revisions: {}, 
                            approaches: {},
                            lastActivity: new Date().toISOString(),
                            studyStreak: 0
                        };
                    }
                } catch (e) {
                    console.error("Error parsing localStorage data:", e);
                    // Initialize empty progress if localStorage is corrupted
                    progressData = { 
                        problems: {}, 
                        notes: {}, 
                        revisions: {}, 
                        approaches: {},
                        lastActivity: new Date().toISOString(),
                        studyStreak: 0
                    };
                }
            }

            function clearUI() {
                // Clear all checkboxes and notes
                document.querySelectorAll('.custom-checkbox').forEach(cb => {
                    cb.checked = false;
                });
                
                // Clear revision checkboxes
                document.querySelectorAll('input[type="checkbox"][data-revision]').forEach(cb => {
                    cb.checked = false;
                });
    
                document.querySelectorAll('.notes-input').forEach(textarea => {
                    textarea.value = '';
                });
                document.querySelectorAll('.approach-badge').forEach(badge => {
                    badge.classList.remove('completed');
                });
            }

            function updateUI() {
                // Update checkboxes
                document.querySelectorAll('.custom-checkbox').forEach(cb => {
                    const problemId = cb.dataset.problem;
                    cb.checked = progressData.problems && progressData.problems[problemId] || false;
                });

                // Update revision checkboxes
                document.querySelectorAll('input[type="checkbox"][data-revision]').forEach(cb => {
                    const revisionId = cb.dataset.revision;
                    cb.checked = progressData.revisions && progressData.revisions[revisionId] || false;
                });

                // Update notes
                document.querySelectorAll('.notes-input').forEach(textarea => {
                    const problemId = textarea.dataset.problem;
                    textarea.value = progressData.notes && progressData.notes[problemId] || '';
                });

                // Update approach badges
                document.querySelectorAll('.approach-badge').forEach(badge => {
                    const problemId = badge.closest('.approach-tracker').dataset.problem;
                    const approach = badge.textContent.toLowerCase().replace(/\s+/g, '-');
                    if (progressData.approaches && progressData.approaches[problemId] && progressData.approaches[problemId][approach]) {
                        badge.classList.add('completed');
                    } else {
                        badge.classList.remove('completed');
                    }
                });
            }

            function showSaveIndicator() {
                const indicator = document.getElementById('saveIndicator');
                indicator.style.display = 'block';
                setTimeout(() => {
                    indicator.style.display = 'none';
                }, 2000);
            }

            // --- Progress Tracking Functions ---
            function saveCheckboxProgress(checkbox) {
                const problemId = checkbox.dataset.problem;
                const revisionId = checkbox.dataset.revision;
                
                // Ensure progressData structure exists
                if (!progressData) {
                    progressData = { problems: {}, notes: {}, revisions: {}, approaches: {} };
                }
                
                if (problemId) {
                    // This is a problem checkbox
                    if (!progressData.problems) progressData.problems = {};
                    progressData.problems[problemId] = checkbox.checked;
                } else if (revisionId) {
                    // This is a revision checkbox
                    if (!progressData.revisions) progressData.revisions = {};
                    progressData.revisions[revisionId] = checkbox.checked;
                }
                
                progressData.lastActivity = new Date().toISOString();
                saveData();
                updateAllProgress();
            }
            
            function saveNote(textarea) {
                const problemId = textarea.dataset.problem;
                
                // Ensure progressData structure exists
                if (!progressData) {
                    progressData = { problems: {}, notes: {}, revisions: {}, approaches: {} };
                }
                
                if (!progressData.notes) progressData.notes = {};
                progressData.notes[problemId] = textarea.value;
                progressData.lastActivity = new Date().toISOString();
                saveData();
            }
    
            function toggleWeek(weekNumber) {
                const content = document.getElementById(`week-${weekNumber}-content`);
                const toggle = content.previousElementSibling.querySelector('.week-toggle');
                
                if (content.classList.contains('active')) {
                    content.classList.remove('active');
                    toggle.textContent = '▼';
                } else {
                    content.classList.add('active');
                    toggle.textContent = '▲';
                }
            }
            
            function updateOverallProgress() {
                const checkboxes = document.querySelectorAll('input[type="checkbox"][data-problem]');
                let completed = 0;
                checkboxes.forEach(cb => {
                    if (progressData.problems && progressData.problems[cb.dataset.problem]) {
                        completed++;
                    }
                });
                completedProblems = completed;
                totalProblems = checkboxes.length; // Update global totalProblems
                const percentage = totalProblems > 0 ? Math.round((completed / totalProblems) * 100) : 0;
                document.getElementById('total-problems').textContent = `${completed}/${totalProblems}`;
            document.getElementById('problems-progress').style.width = percentage + '%';
            document.getElementById('problems-percentage').textContent = percentage + '%';
        }

        function updateWeekProgress() {
            for (let week = 1; week <= 24; week++) {
                    const weekCheckboxes = document.querySelectorAll(`input[data-problem^="w${week}-p"]`);
                const weekTotal = weekCheckboxes.length;
                    let weekCompleted = 0;
                    weekCheckboxes.forEach(cb => {
                        if (progressData.problems && progressData.problems[cb.dataset.problem]) {
                            weekCompleted++;
                        }
                    });
                const weekPercentage = weekTotal > 0 ? Math.round((weekCompleted / weekTotal) * 100) : 0;
                const progressElement = document.getElementById(`week-${week}-progress`);
                if (progressElement) {
                    progressElement.textContent = `${weekCompleted}/${weekTotal} (${weekPercentage}%)`;
                }
            }
            const completedWeeks = Array.from({length: 24}, (_, i) => i + 1).filter(week => {
                    const weekCheckboxes = document.querySelectorAll(`input[data-problem^="w${week}-p"]`);
                    if (weekCheckboxes.length === 0) return false;
                    return Array.from(weekCheckboxes).every(cb => progressData.problems && progressData.problems[cb.dataset.problem]);
            }).length;
            const weeksPercentage = Math.round((completedWeeks / 24) * 100);
            document.getElementById('total-weeks').textContent = `${completedWeeks}/24`;
            document.getElementById('weeks-progress').style.width = weeksPercentage + '%';
            document.getElementById('weeks-percentage').textContent = weeksPercentage + '%';
        }

        function updatePatternProgress() {
                 const patternPercentage = totalProblems > 0 ? Math.round((completedProblems / totalProblems) * 100) : 0;
                document.getElementById('total-patterns').textContent = `${Math.round(28 * (patternPercentage/100))}/28`;
                document.getElementById('patterns-progress').style.width = patternPercentage + '%';
                document.getElementById('patterns-percentage').textContent = patternPercentage + '%';
            }
    
        function updateStreak() {
                if (!currentUser || !progressData.lastActivity) {
                    document.getElementById('study-streak').textContent = `0 days`;
                    document.getElementById('streak-progress').style.width = '0%';
                    return;
                }
                const lastDate = new Date(progressData.lastActivity);
                const today = new Date();
                const diffDays = (today.setHours(0,0,0,0) - lastDate.setHours(0,0,0,0)) / (1000 * 60 * 60 * 24);
                
                let streak = parseInt(progressData.studyStreak || '0');
                if (diffDays === 1) {
                    streak++;
                } else if (diffDays > 1) {
                    streak = 1; // Reset streak
                }
                progressData.studyStreak = streak;

                document.getElementById('study-streak').textContent = `${streak} days`;
                document.getElementById('streak-progress').style.width = Math.min((streak / 30) * 100, 100) + '%';
            }
            
            function updateAllProgress() {
                try {
                if (!currentUser) {
                        const totalProblemsElem = document.getElementById('total-problems');
                        const problemsProgressElem = document.getElementById('problems-progress');
                        const problemsPercentageElem = document.getElementById('problems-percentage');
                        const totalWeeksElem = document.getElementById('total-weeks');
                        const weeksProgressElem = document.getElementById('weeks-progress');
                        const weeksPercentageElem = document.getElementById('weeks-percentage');
                        
                        if (totalProblemsElem) totalProblemsElem.textContent = `0/${totalProblems}`;
                        if (problemsProgressElem) problemsProgressElem.style.width = '0%';
                        if (problemsPercentageElem) problemsPercentageElem.textContent = '0%';
                        if (totalWeeksElem) totalWeeksElem.textContent = '0/24';
                        if (weeksProgressElem) weeksProgressElem.style.width = '0%';
                        if (weeksPercentageElem) weeksPercentageElem.textContent = '0%';
                    updatePatternProgress();
                    updateStreak();
                    return;
                };
                updateOverallProgress();
                updateWeekProgress();
                updatePatternProgress();
                updateStreak();
                } catch (error) {
                    console.warn('⚠️ Error in updateAllProgress:', error);
                }
            }
    
            window.searchProblems = function(query) {
            const searchTerm = query.toLowerCase().trim();
            const weekSections = document.querySelectorAll('.week-section');
                document.querySelectorAll('.search-highlight').forEach(el => el.classList.remove('search-highlight'));
            if (!searchTerm) {
                weekSections.forEach(section => {
                    section.style.display = '';
                        section.querySelectorAll('.problems-table tbody tr').forEach(row => row.style.display = '');
                });
                return;
            }
            weekSections.forEach(section => {
                let weekHasResults = false;
                    section.querySelectorAll('.problems-table tbody tr').forEach(row => {
                        if (row.textContent.toLowerCase().includes(searchTerm)) {
                        row.style.display = '';
                        row.classList.add('search-highlight');
                        weekHasResults = true;
                    } else {
                        row.style.display = 'none';
                    }
                });
                    section.style.display = weekHasResults ? '' : 'none';
                });
            }
            
            window.clearSearch = function() {
            const searchInput = document.getElementById('searchInput');
            searchInput.value = '';
            searchProblems('');
            toggleClearButton('');
            }
            
            function toggleClearButton(query) {
                document.getElementById('clearSearchBtn').style.display = query.trim() ? 'block' : 'none';
            }

            // Filter functions
            window.filterByDifficulty = function(difficulty) {
                // Remove active class from all filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Add active class to clicked button
                event.target.classList.add('active');
                
                // Clear any existing search
                const searchInput = document.getElementById('searchInput');
                searchInput.value = '';
                toggleClearButton('');
                
                // Clear any existing search highlights
                document.querySelectorAll('.search-highlight').forEach(el => {
                    el.classList.remove('search-highlight');
                });
                
                // Filter problems by difficulty
                const weekSections = document.querySelectorAll('.week-section');
                let totalVisible = 0;
                
                weekSections.forEach(section => {
                    let weekHasResults = false;
                    const problemRows = section.querySelectorAll('.problems-table tbody tr');
                    
                    problemRows.forEach(row => {
                        const difficultyCell = row.querySelector('td:nth-child(2) span');
                        if (difficultyCell && difficultyCell.textContent.toLowerCase() === difficulty.toLowerCase()) {
                            row.style.display = '';
                            row.classList.add('search-highlight');
                            weekHasResults = true;
                            totalVisible++;
                        } else {
                            row.style.display = 'none';
                        }
                    });
                    
                    // Show/hide week section based on whether it has matching problems
                    section.style.display = weekHasResults ? '' : 'none';
                });
                
                // Show filter results summary
                showFilterSummary(`${difficulty} Problems (${totalVisible} found)`);
            };

            window.clearFilters = function() {
                // Remove active class from all filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                // Clear search
                const searchInput = document.getElementById('searchInput');
                searchInput.value = '';
                searchProblems('');
                toggleClearButton('');
                
                // Clear search highlights
                document.querySelectorAll('.search-highlight').forEach(el => {
                    el.classList.remove('search-highlight');
                });
                
                // Show all week sections and problem rows
                document.querySelectorAll('.week-section').forEach(section => {
                    section.style.display = '';
                });
                
                document.querySelectorAll('.problems-table tbody tr').forEach(row => {
                    row.style.display = '';
                });
                
                // Hide filter summary
                hideFilterSummary();
            };

            function showFilterSummary(summary) {
                // Remove existing summary if any
                hideFilterSummary();
                
                // Create and show new summary
                const summaryDiv = document.createElement('div');
                summaryDiv.id = 'filter-summary';
                summaryDiv.style.cssText = `
                    position: fixed;
                    top: 100px;
                    right: 20px;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 15px 20px;
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    z-index: 1000;
                    font-weight: 600;
                    animation: slideIn 0.3s ease;
                `;
                summaryDiv.textContent = summary;
                
                document.body.appendChild(summaryDiv);
                
                // Auto-hide after 3 seconds
                setTimeout(() => {
                    hideFilterSummary();
                }, 3000);
            }

            function hideFilterSummary() {
                const existingSummary = document.getElementById('filter-summary');
                if (existingSummary) {
                    existingSummary.remove();
                }
            }

            // Pattern description and hint functions
            window.showPatternDescription = function(pattern) {
                const description = patternDescriptions[pattern];
                if (!description) return;

                // Remove existing pattern description
                hidePatternDescription();

                const descDiv = document.createElement('div');
                descDiv.id = 'pattern-description-popup';
                descDiv.className = 'pattern-description';
                descDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    z-index: 1001;
                    max-width: 400px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                `;
                
                descDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h4>${pattern}</h4>
                        <button onclick="hidePatternDescription()" style="background: none; border: none; font-size: 20px; cursor: pointer; color: #666;">×</button>
                    </div>
                    <p style="margin-bottom: 10px; color: #424242;">${description.description}</p>
                    <div style="margin-bottom: 8px;">
                        <span class="works-for">Works for:</span> ${description.worksFor}
                    </div>
                    <div>
                        <span class="look-for">Look for:</span> ${description.lookFor}
                    </div>
                `;

                document.body.appendChild(descDiv);

                // Auto-hide after 8 seconds
                setTimeout(() => {
                    hidePatternDescription();
                }, 8000);
            };

            window.hidePatternDescription = function() {
                const existingDesc = document.getElementById('pattern-description-popup');
                if (existingDesc) {
                    existingDesc.remove();
                }
            };

            window.showProblemHints = function(pattern) {
                const hints = problemHints[pattern];
                if (!hints) return;

                // Remove existing hints
                hideProblemHints();

                const hintsDiv = document.createElement('div');
                hintsDiv.id = 'problem-hints-popup';
                hintsDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    border: 2px solid #ff9800;
                    border-radius: 10px;
                    padding: 20px;
                    z-index: 1001;
                    max-width: 350px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                `;
                
                hintsDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h4 style="margin: 0; color: #ff9800;">💡 ${pattern} Hints</h4>
                        <button onclick="hideProblemHints()" style="background: none; border: none; font-size: 20px; cursor: pointer; color: #666;">×</button>
                    </div>
                    <ul style="margin: 0; padding-left: 20px;">
                        ${hints.map(hint => `<li style="margin: 8px 0; color: #424242;">${hint}</li>`).join('')}
                    </ul>
                `;

                document.body.appendChild(hintsDiv);

                // Auto-hide after 10 seconds
                setTimeout(() => {
                    hideProblemHints();
                }, 10000);
            };

            window.hideProblemHints = function() {
                const existingHints = document.getElementById('problem-hints-popup');
                if (existingHints) {
                    existingHints.remove();
                }
            };

            // Function to add pattern tooltips to existing pattern cells
            function addPatternTooltips() {
                document.querySelectorAll('.problems-table td:nth-child(3)').forEach(cell => {
                    const pattern = cell.textContent.trim();
                    if (patternDescriptions[pattern]) {
                        cell.classList.add('pattern-badge');
                        cell.style.cursor = 'help';
                        
                        // Add click event for pattern description
                        cell.addEventListener('click', () => {
                            showPatternDescription(pattern);
                        });
                        
                        // Add double-click event for problem hints
                        cell.addEventListener('dblclick', () => {
                            showProblemHints(pattern);
                        });
                        
                        // Add tooltip
                        const tooltip = document.createElement('div');
                        tooltip.className = 'pattern-tooltip';
                        tooltip.innerHTML = `
                            <strong>${pattern}</strong><br>
                            <span class="works-for">Works for:</span> ${patternDescriptions[pattern].worksFor}<br>
                            <span class="look-for">Look for:</span> ${patternDescriptions[pattern].lookFor}<br>
                            <small>Click for details • Double-click for hints</small>
                        `;
                        cell.appendChild(tooltip);
                    }
                });
            }

            window.showAllPatterns = function() {
                // Remove existing pattern guide
                hideAllPatterns();

                const guideDiv = document.createElement('div');
                guideDiv.id = 'all-patterns-guide';
                guideDiv.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: white;
                    border-radius: 15px;
                    padding: 30px;
                    z-index: 1001;
                    max-width: 800px;
                    max-height: 80vh;
                    overflow-y: auto;
                    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
                `;

                const patternsHTML = Object.entries(patternDescriptions).map(([pattern, info]) => `
                    <div class="pattern-description" style="margin-bottom: 20px;">
                        <h4 style="color: #1976d2; margin-bottom: 10px; font-size: 1.1em;">${pattern}</h4>
                        <p style="margin-bottom: 10px; color: #424242; line-height: 1.5;">${info.description}</p>
                        <div style="margin-bottom: 8px;">
                            <span class="works-for">Works for:</span> ${info.worksFor}
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span class="look-for">Look for:</span> ${info.lookFor}
                        </div>
                        <div style="background: #fff3e0; padding: 10px; border-radius: 6px; border-left: 4px solid #ff9800;">
                            <strong style="color: #ff9800;">💡 Quick Hints:</strong>
                            <ul style="margin: 5px 0; padding-left: 20px;">
                                ${problemHints[pattern] ? problemHints[pattern].map(hint => 
                                    `<li style="margin: 3px 0; color: #e65100; font-size: 0.9em;">${hint}</li>`
                                ).join('') : '<li>No specific hints available</li>'}
                            </ul>
                        </div>
                    </div>
                `).join('');

                guideDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; border-bottom: 2px solid #e3f2fd; padding-bottom: 15px;">
                        <h3 style="margin: 0; color: #1976d2; font-size: 1.5em;">📚 DSA Pattern Guide</h3>
                        <button onclick="hideAllPatterns()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">×</button>
                    </div>
                    <div style="margin-bottom: 20px; background: #e8f5e8; padding: 15px; border-radius: 8px; border-left: 4px solid #4caf50;">
                        <strong style="color: #2e7d32;">💡 How to use:</strong>
                        <ul style="margin: 5px 0; padding-left: 20px;">
                            <li>Click on any pattern name in the problems table for detailed info</li>
                            <li>Double-click on pattern names for specific problem-solving hints</li>
                            <li>Use this guide to understand when to apply each pattern</li>
                        </ul>
                    </div>
                    ${patternsHTML}
                `;

                document.body.appendChild(guideDiv);
            };

            window.hideAllPatterns = function() {
                const existingGuide = document.getElementById('all-patterns-guide');
                if (existingGuide) {
                    existingGuide.remove();
                }
            };
            
            window.exportProgress = function() {
                if (!currentUser) {
                    alert("Please log in to export your progress.");
                    return;
                }
                const data = JSON.stringify(progressData, null, 2);
                const blob = new Blob([data], {type: 'application/json'});
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'dsa_progress.json';
                a.click();
                URL.revokeObjectURL(url);
            }

            window.resetProgress = function() {
                if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                    progressData = { problems: {}, notes: {}, revisions: {} };
                    clearUI();
                    saveData();
                    updateAllProgress();
                }
            }

            window.toggleWeek = toggleWeek;
    
            // --- Event Listeners ---
            function reinitializeEventListeners() {
                // Re-attach event listeners for dynamically generated content
            document.querySelectorAll('.custom-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', () => saveCheckboxProgress(checkbox));
            });
                
                // Add event listeners for revision checkboxes (they don't have custom-checkbox class)
                document.querySelectorAll('input[type="checkbox"][data-revision]').forEach(checkbox => {
                    checkbox.addEventListener('change', () => saveCheckboxProgress(checkbox));
                });
                
            document.querySelectorAll('.notes-input').forEach(textarea => {
                textarea.addEventListener('input', () => saveNote(textarea));
            });
            
            // Handle approach badge clicking
            document.querySelectorAll('.approach-badge').forEach(badge => {
                badge.addEventListener('click', () => {
                    badge.classList.toggle('completed');
                        const problemId = badge.closest('.approach-tracker').dataset.problem;
                        const approach = badge.textContent.toLowerCase().replace(/\s+/g, '-');
                        if (currentUser && problemId && approach) {
                            if (!progressData.approaches) progressData.approaches = {};
                            if (!progressData.approaches[problemId]) progressData.approaches[problemId] = {};
                            progressData.approaches[problemId][approach] = badge.classList.contains('completed');
                            saveData();
                        }
                    });
                });

                // Add pattern tooltips and interactions
                addPatternTooltips();
            }
            
            document.querySelectorAll('.custom-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', () => saveCheckboxProgress(checkbox));
            });
            
            // Add event listeners for revision checkboxes (they don't have custom-checkbox class)
            document.querySelectorAll('input[type="checkbox"][data-revision]').forEach(checkbox => {
                checkbox.addEventListener('change', () => saveCheckboxProgress(checkbox));
            });
            
            document.querySelectorAll('.notes-input').forEach(textarea => {
                textarea.addEventListener('input', () => saveNote(textarea));
            });
            
            // Handle approach badge clicking
            document.querySelectorAll('.approach-badge').forEach(badge => {
                badge.addEventListener('click', () => {
                    badge.classList.toggle('completed');
                    const problemId = badge.closest('.approach-tracker').dataset.problem;
                    const approach = badge.textContent.toLowerCase().replace(/\s+/g, '-');
                    if (currentUser && problemId && approach) {
                        if (!progressData.approaches) progressData.approaches = {};
                        if (!progressData.approaches[problemId]) progressData.approaches[problemId] = {};
                        progressData.approaches[problemId][approach] = badge.classList.contains('completed');
                        saveData();
                    }
                });
            });
            
            document.getElementById('searchInput').addEventListener('input', (e) => {
                searchProblems(e.target.value);
                toggleClearButton(e.target.value);
            });

            // Initialize the dynamic content
            async function initializeDynamicContent() {
                try {
                    console.log('🔄 Starting dynamic content initialization...');
                    
                    // Check if dsaLoader is available
                    if (typeof dsaLoader === 'undefined') {
                        throw new Error('dsaLoader is not defined. Check if data-loader.js loaded properly.');
                    }
                    
                    console.log('✅ dsaLoader found:', dsaLoader);
                    
                    // Load and render the DSA data
                    console.log('🔄 Rendering DSA tracker...');
                    await dsaLoader.render('weeks-container');
                    
                    // Hide the loading indicator
                    const loadingElement = document.getElementById('loading');
                    if (loadingElement) {
                        loadingElement.style.display = 'none';
                        console.log('✅ Loading indicator hidden');
                    }
                    
                    // Re-initialize event listeners for the new content
                    console.log('🔄 Re-initializing event listeners...');
                    try {
                        reinitializeEventListeners();
                        console.log('✅ Event listeners re-initialized');
                    } catch (error) {
                        console.warn('⚠️ Error re-initializing event listeners:', error);
                    }
                    
                    // Update UI with any saved progress (with error handling)
                    console.log('🔄 Updating UI with saved progress...');
                    try {
                        updateUI();
                        console.log('✅ UI updated');
                    } catch (error) {
                        console.warn('⚠️ Error updating UI:', error);
                    }
                    
                    try {
                        updateAllProgress();
                        console.log('✅ Progress updated');
                    } catch (error) {
                        console.warn('⚠️ Error updating progress:', error);
                    }
                    
                    console.log('✅ Dynamic content initialized successfully');
                    
                } catch (error) {
                    console.error('❌ Error initializing dynamic content:', error);
                    const loadingElement = document.getElementById('loading');
                    if (loadingElement) {
                        loadingElement.innerHTML = `❌ Error loading data: ${error.message}<br><br>Please check console for details.`;
                    }
                }
            }

            // Start the dynamic content initialization
            initializeDynamicContent();
        });
    </script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>

</body>
</html>
